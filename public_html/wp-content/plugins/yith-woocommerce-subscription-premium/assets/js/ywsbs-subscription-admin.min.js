jQuery(function(n){n("#ywsbs_safe_submit_field").val(""),n("#ywsbs_schedule_subscription_button").on("click",function(i){i.preventDefault(),n("#ywsbs_safe_submit_field").val("schedule_subscription"),n(this).closest("form").submit()}),0<n(document).find(".wp-heading-inline").length&&n('<div class="view-all-subs"><a href="'+ywsbs_subscription_admin.url_back_to_all_subscription+'"> < '+ywsbs_subscription_admin.back_to_all_subscription+"</a></div>").insertBefore(".wp-heading-inline"),n(document).on("click","a.edit_address",function(i){i.preventDefault();var i=n(this),s=i.closest(".subscription_data_column").find("div.edit_address"),t=i.closest(".subscription_data_column").find("a");i.closest(".subscription_data_column").find("div.address").toggle(),t.toggle(),s.toggle()});n(document).on("click",".load_customer_info",function(i){i.preventDefault();var i=n(this),s=i.data("from"),i=i.data("to"),t=s,e=i,s=void 0;if(!0===s||window.confirm(ywsbs_subscription_admin[t===e?"load_"+t:"copy_billing"])){s=n("#user_id").val();if(0===s)return void window.alert(ywsbs_subscription_admin.no_customer_selected);s={user_id:s,action:"woocommerce_get_customer_details",security:ywsbs_subscription_admin.get_customer_details_nonce};n.ajax({url:ywsbs_subscription_admin.ajaxurl,data:s,type:"POST",success:function(i){console.log(i),i&&i[t]&&n.each(i[t],function(i,s){n("#_"+e+"_"+i).val(s).change()})}})}}),n.fn.datetimepicker!==undefined&&n(document).find(".ywsbs-timepicker").each(function(){n(this).prop("placeholder","YYYY-MM-DD HH:mm")}).datetimepicker({timeFormat:"HH:mm:ss",defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,showSeconds:!1}),n(document).find(".ui-datepicker").addClass("yith-plugin-fw-datepicker-div"),n("#ywsbs_schedule_subscription_button").on("click",function(i){i.preventDefault(),n("#ywsbs_safe_submit_field").val("schedule_subscription"),n(this).closest("form").submit()});var s={content:undefined,init:function(){this.content=n(document).find("#woocommerce-order-items"),this.content.on("click","a.edit-order-item",this.edit_item),this.content.on("click",".cancel-action",this.cancel_edit_items.bind(this)),this.content.on("click",".save-action",this.save_items),this.content.on("click",".recalculate-action",this.recalculate)},edit_item:function(){return n(this).closest("tr").find(".view").hide(),n(this).closest("tr").find(".edit").show(),n(this).hide(),n(".wc-order-add-item").show(),n(".wc-order-recalculate").hide(),!1},cancel_edit_items:function(){this.content.find(".wc-order-recalculate, .edit-order-item, .view").show(),this.content.find(".wc-order-add-item, .edit").hide()},save_items:function(){var i={subscription_id:n("#post_ID").val(),items:n("table.woocommerce_order_items :input[name], .wc-order-totals-items :input[name]").serialize(),action:"ywsbs_save_items",security:ywsbs_subscription_admin.save_item_nonce};return n.ajax({url:ywsbs_subscription_admin.ajaxurl,data:i,type:"POST",beforeSend:function(){n("#woocommerce-order-items").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},success:function(i){n("#ywsbs-product-subscription").find(".inside").empty().append(i),n("#woocommerce-order-items").unblock(),s.init()}}),!1},recalculate:function(){var i={subscription_id:n("#post_ID").val(),action:"ywsbs_recalculate",security:ywsbs_subscription_admin.recalculate_nonce};n.ajax({url:ywsbs_subscription_admin.ajaxurl,data:i,type:"POST",beforeSend:function(){n("#woocommerce-order-items").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},success:function(i){n("#ywsbs-product-subscription").find(".inside").empty().append(i),n("#woocommerce-order-items").unblock(),s.init()}})}};s.init(),0<n(".ywsbs-export").length&&(n(".wp-header-end").before(n(".ywsbs-export")),n(".ywsbs-export").css({display:"inline-block"})),n(document).on("click",".remove-coupon",function(){var i=n(this),s=i.data("code"),i=(n("#ywsbs-product-subscription").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),{action:"ywsbs_remove_subscription_coupon",dataType:"json",subscription_id:n("#post_ID").val(),security:i.data("nonce"),coupon:s});n.post(ywsbs_subscription_admin.ajaxurl,i,function(i){i.success?n("#ywsbs-product-subscription").find(".inside").empty().append(i.data.html):window.alert(i.data.error),n("#ywsbs-product-subscription").unblock()})}),n(document).on("click",".add-coupon",function(){var i=n(this),s=window.prompt(ywsbs_subscription_admin.add_coupon_text);return null!==s&&(n("#ywsbs-product-subscription").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),i={action:"ywsbs_add_subscription_coupon",dataType:"json",subscription_id:n("#post_ID").val(),security:i.data("nonce"),coupon:s.trim(),user_id:n("#user_id").val(),user_email:n("#_billing_email").val()},n.post(ywsbs_subscription_admin.ajaxurl,i,function(i){i.success?n("#ywsbs-product-subscription").find(".inside").empty().append(i.data.html):window.alert(i.data.error),n("#ywsbs-product-subscription").unblock()})),!1})});